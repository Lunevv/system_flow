# üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Vercel (–æ–Ω–ª–∞–π–Ω-–¥–æ—Å—Ç—É–ø)

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

–ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:

### **–õ–æ–∫–∞–ª—å–Ω–æ** (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):
- `proxy-server.js` –Ω–∞ –ø–æ—Ä—Ç—É 3001
- Vite dev server –Ω–∞ –ø–æ—Ä—Ç—É 3000
- –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ CLI

### **–û–Ω–ª–∞–π–Ω –Ω–∞ Vercel** (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞):
- Serverless Functions (`/api/metabase.js`, `/api/update-data.js`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Vercel Cron
- –î–æ—Å—Ç—É–ø –ø–æ —Å—Å—ã–ª–∫–µ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üåê –î–µ–ø–ª–æ–π –Ω–∞ Vercel

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```bash
npm install -g vercel
```

### 2. –í–æ–π–¥–∏—Ç–µ –≤ Vercel
```bash
vercel login
```

### 3. –î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π (—Å–æ–∑–¥–∞—Å—Ç –ø—Ä–æ–µ–∫—Ç)
vercel

# –ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–π
vercel --prod
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Vercel Cron (—Ç–æ–ª—å–∫–æ –Ω–∞ –ø–ª–∞—Ç–Ω—ã—Ö –ø–ª–∞–Ω–∞—Ö)

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: Vercel Cron —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ **Pro –ø–ª–∞–Ω–µ** ($20/–º–µ—Å—è—Ü)

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Dashboard ‚Üí Settings ‚Üí Cron Jobs
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ cron job –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üÜì –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–±–µ–∑ Pro –ø–ª–∞–Ω–∞)

–ï—Å–ª–∏ —É –≤–∞—Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω Vercel, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π cron —Å–µ—Ä–≤–∏—Å:

### **–í–∞—Ä–∏–∞–Ω—Ç 1: cron-job.org** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [cron-job.org](https://cron-job.org)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Cronjob:
   - **URL**: `https://your-app.vercel.app/api/update-data`
   - **Method**: POST
   - **Schedule**: `0 6 * * *` (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### **–í–∞—Ä–∏–∞–Ω—Ç 2: GitHub Actions** (100% –±–µ—Å–ø–ª–∞—Ç–Ω–æ)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.github/workflows/update-data.yml`:

```yaml
name: Update Metabase Data Daily

on:
  schedule:
    - cron: '0 6 * * *'  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00 UTC
  workflow_dispatch:      # –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Data Update
        run: |
          curl -X POST https://your-app.vercel.app/api/update-data
```

–ó–∞–º–µ–Ω–∏—Ç–µ `your-app.vercel.app` –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π URL.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è Vercel

```
system-flow/
‚îú‚îÄ‚îÄ api/                        # Serverless Functions
‚îÇ   ‚îú‚îÄ‚îÄ metabase.js            # Proxy –¥–ª—è Metabase API
‚îÇ   ‚îî‚îÄ‚îÄ update-data.js         # API –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ main.jsx
‚îú‚îÄ‚îÄ dist/                       # Build –ø–∞–ø–∫–∞ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ cached_stats.csv       # –ö—ç—à –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îú‚îÄ‚îÄ vercel.json                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vercel + Cron
‚îî‚îÄ‚îÄ package.json
```

---

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Vercel

### **1. API –∑–∞–ø—Ä–æ—Å—ã**
```
Frontend ‚Üí /api/metabase?id=XXX&days=7
         ‚Üì
    Serverless Function
         ‚Üì
    Metabase API (ucoz.metabaseapp.com)
         ‚Üì
    –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö
```

### **2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
```
Vercel Cron (–∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
         ‚Üì
POST /api/update-data
         ‚Üì
–ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ Metabase
         ‚Üì
(–í –±—É–¥—É—â–µ–º: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∏–ª–∏ Vercel Blob)
```

---

## üóÑÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–≤–∞–∂–Ω–æ!)

### **–ü—Ä–æ–±–ª–µ–º–∞:**
Vercel serverless functions **–Ω–µ –º–æ–≥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ –¥–∏—Å–∫**. 
–§–∞–π–ª `cached_stats.csv` –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∏–∑ –ø–∞–ø–∫–∏ `dist/` (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –ø—Ä–∏ –±–∏–ª–¥–µ).

### **–†–µ—à–µ–Ω–∏—è:**

#### **–í–∞—Ä–∏–∞–Ω—Ç 1: Vercel Blob Storage** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
npm install @vercel/blob
```

–í `api/update-data.js` —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ Blob:
```javascript
import { put } from '@vercel/blob';

const blob = await put('cached_stats.csv', csvData, {
  access: 'public',
});
```

#### **–í–∞—Ä–∏–∞–Ω—Ç 2: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL/MySQL)**
- Vercel Postgres (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è)
- Supabase (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
- PlanetScale (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)

#### **–í–∞—Ä–∏–∞–Ω—Ç 3: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫—ç—à –ø—Ä–∏ –±–∏–ª–¥–µ**
–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤–æ –≤—Ä–µ–º—è `npm run build`:
```json
{
  "scripts": {
    "build": "node manage-data.js update && vite build"
  }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ serverless —Ñ—É–Ω–∫—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI
npm install -g vercel

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä Vercel
vercel dev
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞ `http://localhost:3000` —Å —Ä–∞–±–æ—Ç–∞—é—â–∏–º–∏ API routes.

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ Vercel:**
1. Dashboard ‚Üí Deployments ‚Üí Latest
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Functions"
3. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ Cron Jobs:**
1. Dashboard ‚Üí Settings ‚Üí Cron Jobs
2. –°–º–æ—Ç—Ä–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### **–†—É—á–Ω–æ–π —Ç—Ä–∏–≥–≥–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```bash
curl -X POST https://your-app.vercel.app/api/update-data
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ó–∞—â–∏—Ç–∏—Ç–µ API –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

```javascript
// api/update-data.js
export default async function handler(req, res) {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
  const authHeader = req.headers.authorization;
  if (authHeader !== `Bearer ${process.env.CRON_SECRET}`) {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

–í Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables:
- `CRON_SECRET` = `your-secret-token`

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –ü—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ (`npm run build`)
- [ ] Serverless —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ª–æ–∫–∞–ª—å–Ω–æ (`vercel dev`)
- [ ] `vercel.json` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Environment variables –¥–æ–±–∞–≤–ª–µ–Ω—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
- [ ] –í—ã–±—Ä–∞–Ω –º–µ—Ç–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- [ ] –†–µ—à—ë–Ω –≤–æ–ø—Ä–æ—Å —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Blob/DB/Static)

---

## üÜò –ü–æ–º–æ—â—å

### **Vercel –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 –Ω–∞ /api/***
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–∞–ø–∫–∞ `api/` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª—ã `.js` –∞ –Ω–µ `.jsx`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `vercel --prod`

### **Cron –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É –≤–∞—Å Pro –ø–ª–∞–Ω Vercel
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π cron —Å–µ—Ä–≤–∏—Å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤ `vercel.json`

### **–î–∞–Ω–Ω—ã–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `/api/update-data`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Metabase API –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è



